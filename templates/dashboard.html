<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Sistem Grooming Hewan</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
{% extends 'base.html' %}

{% block title %}Dashboard - Grooming{% endblock %}

{% block content %}
<div class="">
    <div class="card-hero mb-4">
        <h1 class="mb-1" style="color:#2D7A4D; font-weight:900; font-size:48px; margin-bottom:6px;">Dashboard</h1>
        <p class="mb-0" style="color:#2D7A4D; opacity:0.9">Selamat datang, {{ current_user.username }}! Kelola hewan peliharaan dan booking Anda.</p>
    </div>

    {% if total_revenue is not none %}
    <div class="alert alert-success">Total Pendapatan (selesai): <strong>Rp {{ '{:,.0f}'.format(total_revenue) }}</strong></div>
    {% endif %}

    <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
            {% if current_user.role == 'staff' %}
                <a href="/booking" class="btn btn-success">‚ûï Buat Booking</a>
            {% endif %}
        </div>
        <div>
            <a href="/manage_bookings" class="btn btn-outline-info">Daftar Booking</a>
        </div>
    </div>

    <h4 class="mt-3">Daftar Booking</h4>
    <div class="table-responsive">
    <table class="table table-booking">
        <thead>
        <tr>
            <th>No</th>
            <th>Hewan</th>
            <th>Pemilik</th>
            <th>Tanggal</th>
            <th>Waktu</th>
            <th>Layanan</th>
            <th>Status</th>
            <th>Aksi</th>
        </tr>
        </thead>
        <tbody>
        {% for b in data %}
        <tr {% if loop.index is odd %}class="bg-white"{% else %}class="bg-light"{% endif %}>
            <td>{{ loop.index }}</td>
            <td class="text-success">{{ b.nama_hewan }}</td>
            <td>{{ b.owner_name if b.owner_name else '-' }}</td>
            <td>{{ b.tanggal }}</td>
            <td>‚è∞ {{ b.jam if b.jam else '-' }}</td>
            <td>{{ services.get(b.service_id).name if services.get(b.service_id) else '-' }}</td>
            <td>
                {% if b.status == 'pending' %}
                    <span class="badge-status badge-pending">Pending</span>
                {% elif b.status == 'done' %}
                    <span class="badge-status badge-done">Confirmed</span>
                {% else %}
                    <span class="badge-status badge-canceled">{{ b.status }}</span>
                {% endif %}
            </td>
            <td>
                {% if current_user.role == 'admin' %}
                    <a class="btn btn-sm btn-warning" href="/edit/{{ b.id }}">‚úèÔ∏è</a>
                    <a class="btn btn-sm btn-danger" href="/delete/{{ b.id }}">üóë</a>
                {% elif current_user.role == 'staff' %}
                    <a class="btn btn-sm btn-outline-secondary" href="/manage_bookings">Detail</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    </div>

    <div class="mt-5">
        <h3>Daftar Layanan</h3>
        <div class="row">
            {% for s in services_list %}
            <div class="col-md-6 mb-3">
                <div class="p-3 border rounded bg-light">
                    <h5 class="text-success">{{ s.name }}</h5>
                    <p class="text-muted">{{ s.description }}</p>
                    <div class="fw-bold">Rp {{ '{:,.0f}'.format(s.price) }}</div>
                    <div class="text-muted">Durasi: {{ s.duration }}</div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

</div>
{% endblock %}
            </td>
